{"ast":null,"code":"var _jsxFileName = \"/Users/jantemmerman/Documents/School/Schijf3/CMSDEV/headlesswpXreact/app/src/pages/addPost.jsx\";\nimport React from 'react';\nimport styles from '../css/addPost.module.css';\n\nclass AddPosts extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.uploadImage = (token, formData) => {\n      console.log(JSON.parse(formData));\n      const image = this.fileInput.current.files[0];\n      fetch(process.env.REACT_APP_WP_URL + '/wp/wp-json/wp/v2/media', {\n        method: \"POST\",\n        headers: {\n          'Content-Type': 'image/jpeg',\n          'Content-Disposition': 'attachment; filename=tmp.jpg',\n          'Accept': 'application/json',\n          'Authorization': 'Bearer ' + token\n        },\n        body: formData\n      }).then(response => {\n        console.log(response);\n        return response.json();\n      }).then(data => {\n        console.log(data);\n      });\n    };\n\n    this.checkResponse = data => {\n      if (!data.code) {\n        this.setState({\n          errorMessage: \"\"\n        });\n        window.location.assign(process.env.REACT_APP_REACT_URL + '/');\n      } else {\n        this.setState({\n          errorMessage: \"Something went wrong.. Are you logged in?\"\n        });\n      }\n    };\n\n    this.onChange = e => {\n      const files = Array.from(e.target.files);\n      const formData = new FormData();\n      formData.append('file', files[0]);\n      this.uploadImage(localStorage.getItem('bearerToken'), formData);\n    };\n\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleInputChange = this.handleInputChange.bind(this);\n    this.fileInput = React.createRef();\n    this.state = {\n      title: '',\n      content: '',\n      errorMessage: \"\"\n    };\n  }\n\n  handleSubmit() {\n    console.log(this.fileInput.current.files[0].path);\n    const token = localStorage.getItem('bearerToken');\n    this.uploadImage(token);\n    fetch(process.env.REACT_APP_WP_URL + '/wp/wp-json/wp/v2/posts/', {\n      method: \"POST\",\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'Authorization': 'Bearer ' + token\n      },\n      body: JSON.stringify({\n        'title': this.state.title,\n        'content': this.state.content,\n        'status': 'publish'\n      })\n    }).then(response => {\n      return response.json();\n    }).then(data => {\n      this.checkResponse(data);\n    });\n  }\n\n  handleInputChange(event) {\n    const target = event.target;\n    const value = target.value;\n    const name = target.name;\n    this.setState({\n      [name]: value\n    });\n  }\n\n  render() {\n    if (localStorage.getItem('bearerToken')) return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"Add a post\"), React.createElement(\"div\", {\n      className: styles.formContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      method: \"post\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.inputContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: styles.label,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"Title\"), React.createElement(\"input\", {\n      className: styles.input,\n      name: \"title\",\n      type: \"text\",\n      value: this.state.username,\n      onChange: this.handleInputChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: styles.inputContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: styles.label,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"Content\"), React.createElement(\"textarea\", {\n      className: styles.textarea,\n      name: \"content\",\n      value: this.state.password,\n      onChange: this.handleInputChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: styles.inputContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: styles.label,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, \"Image\"), React.createElement(\"input\", {\n      type: \"file\",\n      accept: \"image/*\",\n      onChange: this.onChange,\n      ref: this.fileInput,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }))), React.createElement(\"button\", {\n      className: styles.button,\n      type: \"Submit\",\n      onClick: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, \"Publish\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, this.state.errorMessage)));else return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \"Add a post\"), React.createElement(\"div\", {\n      className: styles.container,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, \"Login to add posts.\")));\n  }\n\n}\n\nexport default AddPosts;","map":{"version":3,"sources":["/Users/jantemmerman/Documents/School/Schijf3/CMSDEV/headlesswpXreact/app/src/pages/addPost.jsx"],"names":["React","styles","AddPosts","Component","constructor","props","uploadImage","token","formData","console","log","JSON","parse","image","fileInput","current","files","fetch","process","env","REACT_APP_WP_URL","method","headers","body","then","response","json","data","checkResponse","code","setState","errorMessage","window","location","assign","REACT_APP_REACT_URL","onChange","e","Array","from","target","FormData","append","localStorage","getItem","handleSubmit","bind","handleInputChange","createRef","state","title","content","path","stringify","event","value","name","render","formContainer","inputContainer","label","input","username","textarea","password","button","container"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport styles from '../css/addPost.module.css'\n\nclass AddPosts extends React.Component {\n    constructor(props) {\n        super(props)\n        this.handleSubmit = this.handleSubmit.bind(this)\n        this.handleInputChange = this.handleInputChange.bind(this)\n        this.fileInput = React.createRef();\n        this.state = {\n            title: '',\n            content: '',\n            errorMessage: \"\",\n        }\n    }\n\n    handleSubmit() {\n        console.log(this.fileInput.current.files[0].path)\n        const token = localStorage.getItem('bearerToken')\n        this.uploadImage(token)\n        fetch(process.env.REACT_APP_WP_URL + '/wp/wp-json/wp/v2/posts/', {\n            method: \"POST\",\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json',\n                'Authorization': 'Bearer ' + token,\n            },\n            body: JSON.stringify({\n                'title': this.state.title,\n                'content': this.state.content,\n                'status': 'publish'\n            }),\n        }).then((response) => {\n            return response.json();\n        }).then((data) => {\n            this.checkResponse(data)\n        });\n    }\n\n    uploadImage = (token, formData) => {\n        console.log(JSON.parse(formData))\n        const image = this.fileInput.current.files[0]\n        fetch(process.env.REACT_APP_WP_URL + '/wp/wp-json/wp/v2/media', {\n            method: \"POST\",\n            headers: {\n                'Content-Type': 'image/jpeg',\n                'Content-Disposition': 'attachment; filename=tmp.jpg',\n                'Accept': 'application/json',\n                'Authorization': 'Bearer ' + token,\n            },\n            body: formData\n        }).then((response) => {\n            console.log(response)\n            return response.json();\n        }).then((data) => {\n            console.log(data)\n        });\n    }\n\n    checkResponse = (data) => {\n        if(!data.code) {\n            this.setState({\n                errorMessage: \"\"\n            })\n            window.location.assign(process.env.REACT_APP_REACT_URL + '/'); \n        } else {\n            this.setState({\n                errorMessage: \"Something went wrong.. Are you logged in?\"\n            })\n        }\n    }\n\n    handleInputChange(event) {\n        const target = event.target;\n        const value = target.value;\n        const name = target.name;\n\n        this.setState({\n          [name]: value\n        });\n    }\n\n    onChange = e => {\n        const files = Array.from(e.target.files)\n\n        const formData = new FormData()\n            formData.append('file', files[0])\n            \n        this.uploadImage(localStorage.getItem('bearerToken'), formData)\n    } \n\n    render() {\n            if(localStorage.getItem('bearerToken'))\n            return (\n                <div>\n                    <h1>Add a post</h1>\n                    <div className={styles.formContainer} >\n                        <form method=\"post\">\n                            <div className={styles.inputContainer}>\n                                <label className={styles.label}>Title</label>\n                                <input\n                                    className={styles.input} \n                                    name=\"title\"\n                                    type=\"text\"\n                                    value={this.state.username}\n                                    onChange={this.handleInputChange} />\n                            </div>\n                            <div className={styles.inputContainer}>\n                                <label className={styles.label}>Content</label>\n                                <textarea\n                                    className={styles.textarea} \n                                    name=\"content\"\n                                    value={this.state.password}\n                                    onChange={this.handleInputChange} />\n                            </div>\n                            <div className={styles.inputContainer}>\n                                <label className={styles.label}>Image</label>\n                                <input type=\"file\" accept=\"image/*\" onChange={this.onChange} ref={this.fileInput}/>\n                                \n                            </div>\n                        </form>\n                        <button className={styles.button} type='Submit' onClick={this.handleSubmit}>Publish</button>\n                        <p>{this.state.errorMessage}</p>\n                    </div>\n                </div>\n            ) \n        else\n            return (\n                <div>\n                    <h1>Add a post</h1>\n                    <div className={styles.container}>\n                        <p>Login to add posts.</p>\n                    </div>\n                </div>\n            )\n\n    }\n}\n\n\nexport default AddPosts\n"]},"metadata":{},"sourceType":"module"}